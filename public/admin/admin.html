<!DOCTYPE html>
<html>
<head lang="en">
    <!--Angular is loaded to the global namespace, not using System.js-->
    <!--Some background: http://stackoverflow.com/questions/32257101/why-system-js-returns-an-empty-object-instead-of-angularjs-->
    <script src="../angular/angular.js"></script>

    <!--This is the main module loader-->
    <script src="../systemjs/dist/system.js"></script>

    <!--System.js config settings and angular bootstrap-->
    <script src="../bootstrap.js"></script>

    <!--<link rel="stylesheet" href="../bootstrap/dist/css/bootstrap.min.css">-->
    
    <script src="AdminController.js"></script>
    
    <link rel="stylesheet" href="admin.css">
    <title>SpaceGame - Admin</title>
</head>
<body ng-controller="AdminController as ctrl">
    <div ng-show="question !== null || message !== null">
        <div ng-show="question !==null">
            <span>
                {{question}}
            </span>
            <div>
                <button ng-click="ctrl.answerQuestion(true)">Yes</button>
                <button ng-click="ctrl.answerQuestion(false)">No</button>
            </div>
        </div>
        <div ng-show="message !==null">
            <span>
                {{message}}
            </span>
            <div>
                <button ng-click="message = null">OK</button>
            </div>
        </div>
    </div>
    <table>
        <tr>
            <td>
                <button ng-click="ctrl.selectMenu('home')" class="menu" ng-mouseenter="ctrl.hover($event)" ng-mouseleave="ctrl.unhover($event)">Home</button>
                <button ng-click="ctrl.selectMenu('players')" class="menu" ng-mouseenter="ctrl.hover($event)" ng-mouseleave="ctrl.unhover($event)">Players</button>
                <button ng-click="ctrl.selectMenu('rooms')" class="menu" ng-mouseenter="ctrl.hover($event)" ng-mouseleave="ctrl.unhover($event)">Rooms</button>
                <button ng-click="ctrl.setQuestion('logout')" class="menu" ng-mouseenter="ctrl.hover($event)" ng-mouseleave="ctrl.unhover($event)">Logout</button>
            </td>
            <td>
                <h2>
                    <span>{{selectedMenu | capitalize}}</span>
                    <button ng-click="ctrl.refresh()" ng-mouseenter="ctrl.hover($event)" ng-mouseleave="ctrl.unhover($event)">Refresh</button>
                </h2>
                <div ng-show="selectedMenu==='home'">
                    <div class="status-line">
                        <span ng-if="Database" class="success status">Database is connected</span>
                        <span ng-if="!Database" class="fail status">Database is disconnected</span>
                    </div>
                    <div>
                        <span>Send text to all clients: </span>
                        <input type="text" ng-model="allChatText" class="chatbox" ng-keyup="$event.keyCode === 13 && ctrl.allChat()"/>
                        <button ng-click="ctrl.allChat()" ng-mouseenter="ctrl.hover($event)" ng-mouseleave="ctrl.unhover($event)">Send</button>
                    </div>
                    <div>
                        <span>Auto refresh: ({{refreshtext}}) </span>
                        <input type="text" ng-model="refresh" ng-change="ctrl.change()"/>
                    </div>
                    <button ng-click="ctrl.setQuestion('stopServer')" ng-mouseenter="ctrl.hover($event)" ng-mouseleave="ctrl.unhover($event)">Stop server</button>
                </div>
                
                <div ng-show="selectedMenu==='players'">
                    <table>
                        <tr>
                            <th>Player</th>
                            <th>State</th>
                            <th>Room</th>
                        </tr>
                        <tr ng-repeat="data in Users">
                            <td>{{data.playerName}}</td>
                            <td>{{data.state}}</td>
                            <td>{{data.room}}</td>
                        </tr>
                    </table>
                </div>
                
                <div ng-show="selectedMenu==='rooms'">
                    <table>
                        <tr>
                            <th>Name</th>
                            <th>Host</th>
                            <th>Number of players</th>
                        </tr>
                        <tr ng-repeat="data in Rooms">
                            <td>{{data.name}}</td>
                            <td>{{data.host}}</td>
                            <td>{{data.numOfPlayers}}</td>
                        </tr>
                    </table>
                </div>
            </td>
        </tr>
    </table>
</body>